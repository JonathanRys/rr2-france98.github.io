<!DOCTYPE html>
<html lang="en_US">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Calculateur de conquête pour le jeu Royal Revolt 2 de Flare Game - By Sir Lunar Knight - From France 98" />
    <title>Conquest Calculator</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Berkshire+Swash&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" type="text/css" href="./css/calculator.css"/>
</head>
<body>
    <header>
      <div class="header">
        <h1 data-i18n-key="conquest_calculator">Calculateur de Conquête</h1>
      </div>
    </header>
    <div id="container" class="container-fluid">
      <form class="mb-3">
        <div class="form-group row flex-row-reverse">
          <div class="col-6 col-md-4">
            <div id="language-dropdown" data-selected-lang="en" class="dropdown p-1">
              <a class="btn btn-light dropdown-toggle float-end" href="#" role="button" data-bs-toggle="dropdown">
                <img id="lang-flag" src="./img/en.png" alt="en" width="32" height="21" /> English
              </a>
              <ul id="language-dropdown-options" class="dropdown-menu"></ul>
            </div>
          </div>
        </div>
        <hr />
        <div class="form-group row">
          <div class="col-12 col-md-4">
          </div>
          <div class="col-6 col-md-4 center">
            <label class="center bold" data-i18n-key="you">Vous</label>
          </div>
          <div class="col-6 col-md-4 center">
            <label class="center bold" data-i18n-key="opponent">Adversaire</label>
          </div>
        </div>
        <div class="form-group row">
          <div class="d-none d-md-block col-md-4">
            <label class="col-form-label" data-i18n-key="skull_needed_sv">Skulls needed (SV)</label>
          </div>
          <div class="col-6 col-md-4 center">
            <div class="output bold" id="skull_team">0</div>
          </div>
          <div class="col-6 col-md-4 center">
            <div class="output bold" id="skull_opponent">0</div>
          </div>
          <div class="icon skull"></div>
        </div>
        <div class="form-group row">
          <div class="d-none d-md-block col-md-4">
            <label class="col-form-label" data-i18n-key="energy_per_fight">Energy per fight</label>
          </div>
          <div class="col-6 col-md-4 center">
            <div class="output" id="power_team">0</div>
          </div>
          <div class="col-6 col-md-4 center">
            <div class="output" id="power_opponent">0</div>
          </div>
          <div class="icon energy"></div>
        </div>
        <div class="form-group row">
          <div class="d-none d-md-block col-md-4">
            <label class="col-form-label" data-i18n-key="rating">Rating (Attack / Defense)</label>
          </div>
          <div class="col-6 col-md-4 center">
            <div class="output" id="attackdef_team">0</div>
          </div>
          <div class="col-6 col-md-4 center">
            <div class="output" id="attackdef_opponent">0</div>
          </div>
          <div class="icon rating"></div>
        </div>
        <hr />
        <div class="form-group row">
          <div class="col-12 col-md-4">
            <label class="col-form-label" data-i18n-key="who_attacking">Qui attaque ?</label>
          </div>
          <div class="col-6 col-md-4 center">
            <div id="team" class="output" data-i18n-key="attacker">Attacker</div>
          </div>
          <div class="col-6 col-md-4 center">
            <div id="opponent" class="output" data-i18n-key="defender">Defender</div>
          </div>
          <div id="attacker-toggle" class="btn btn-sm btn-light center-button">
              <input type="hidden" id="attacker" value="team" />
          </div>
        </div>
        <div class="form-group row">
          <div class="col-12 col-md-4">
            <label class="col-form-label" data-i18n-key="time_left">Temps restant</label>
          </div>
          <div class="col-6 col-md-4">
            <input type="number"
              min="0"
              max="23"
              step="1"
              value="24"
              class="form-control form-control-sm"
              id="time_hour"
              placeholder="Hours (24)"
              data-i18n-key="hours"
              required>
          </div>
          <div class="col-6 col-md-4">
            <input type="number"
              min="0"
              max="59"
              step="1"
              value="00"
              class="form-control form-control-sm"
              id="time_minute"
              placeholder="Minutes (00)"
              data-i18n-key="minutes"
              required>
          </div>
        </div>
        <div class="form-group row">
          <div class="col-12 col-md-4">
            <label class="col-form-label" data-i18n-key="number_skull_won">Nombre de Crânes gagnés</label>
          </div>
          <div class="col-6 col-md-4 center">
            <input type="number"
              class="form-control form-control-sm"
              min="0"
              step="1"
              id="skull_win_team">
          </div>
          <div class="col-6 col-md-4 center">
            <input type="number"
              class="form-control form-control-sm"
              min="0"
              step="1"
              id="skull_win_opponent">
          </div>
        </div>
        <div class="form-group row">
          <div class="col-12 col-md-4">
            <label class="col-form-label" data-i18n-key="number_heroes">Nombre de Héros</label>
          </div>
          <div class="col-6 col-md-4 center">
            <input type="number"
              class="form-control form-control-sm"
              min="0"
              max="65" step="1"
              id="nb_player_team"
              required>
          </div>
          <div class="col-6 col-md-4 center">
            <input type="number"
              class="form-control form-control-sm"
              min="0"
              max="65" step="1"
              id="nb_player_opponent"
              required>
          </div>
        </div>
        <div class="form-group row">
          <div class="col-12 col-md-4">
            <label class="col-form-label" data-i18n-key="number_troops">Nombre de Troupes</label>
          </div>
          <div class="col-6 col-md-4 center">
            <input type="number"
              class="form-control form-control-sm"
              min="0"
              step="1"
              id="nb_troop_team">
          </div>
          <div class="col-6 col-md-4 center">
            <input type="number"
              class="form-control form-control-sm"
              min="0"
              step="1"
              id="nb_troop_opponent">
          </div>
        </div>
        <div class="form-group row">
          <div class="col-12 col-md-4">
            <label class="col-form-label" data-i18n-key="ground">Terrain</label>
          </div>
          <div class="col-12 col-md-8">
            <select class="form-select form-select-sm double" id="ground">
              <option selected value="0.7;1.3" data-i18n-key="ground_forest">Forêt (0.7 / 1.3)</option>
              <option value="1;0.8" data-i18n-key="ground_meadow">Prairie (1 / 0.8)</option>
              <option value="1;1" data-i18n-key="ground_swamp">Marais (1 / 1)</option>
              <option value="0.8;0.5" data-i18n-key="ground_desert">Désert (0.8 / 0.5)</option>
              <option value="0.9;1.1" data-i18n-key="ground_hills">Collines (0.9 / 1.1)</option>
              <option value="0.7;1.5" data-i18n-key="ground_rocky_hills">Collines rocheuses (0.7 / 1.5)</option>
              <option value="0.9;0.7" data-i18n-key="ground_sandy_hills">Collines sableuses (0.9 / 0.7)</option>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <div class="col-12 col-md-4">
            <label class="col-form-label" data-i18n-key="tower_level">Niveau Tour</label>
          </div>
          <div class="col-12 col-md-8">
            <select class="form-select form-select-sm double" id="tower_level">
              <option selected value="1">0</option>
              <option value="1.2">1</option>
              <option value="1.5">2</option>
              <option value="2">3</option>
              <option value="2.5">4</option>
            </select>
          </div>
        </div>
      </form>
      <form>
        <div class="row">
            <div class="accordion accordion-flush" id="tech-accordion">
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button bold" type="button" data-bs-toggle="collapse" data-bs-target="#tech-section-collapse">
                    Technology
                  </button>
                </h2>
                <div id="tech-section-collapse" class="accordion-collapse collapse show" data-bs-parent="#tech-accordion">
                  <div id="tech-section" class="accordion-body">
                    <div class="form-group row">
                      <div class="col-12 col-md-4">
                        <label class="col-form-label" data-i18n-key="attack_value_troops">Valeur d’attaque Troupes +1</label>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="attack_team_troop">
                          <option value="1">0</option>
                          <option value="2">1</option>
                          <option value="3">2</option>
                          <option value="4">3</option>
                        </select>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="attack_opponent_troop">
                          <option value="1">0</option>
                          <option value="2">1</option>
                          <option value="3">2</option>
                          <option value="4">3</option>
                        </select>
                      </div>
                    </div>
                    <div class="form-group row">
                      <div class="col-12 col-md-4">
                        <label class="col-form-label" data-i18n-key="defense_value_troops">Valeur de défense Troupes +1</label>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="def_team_troop">
                          <option value="1">0</option>
                          <option value="2">1</option>
                          <option value="3">2</option>
                          <option value="4">3</option>
                        </select>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="def_opponent_troop">
                          <option value="1">0</option>
                          <option value="2">1</option>
                          <option value="3">2</option>
                          <option value="4">3</option>
                        </select>
                      </div>
                    </div>

                    <div class="form-group row">
                      <div class="col-12 col-md-4">
                        <label class="col-form-label" data-i18n-key="attack_value_heroes">Valeur d’attaque Héros +5</label>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="attack_team_hero">
                          <option value="0">0</option>
                          <option value="5">1</option>
                          <option value="10">2</option>
                          <option value="15">3</option>
                        </select>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="attack_opponent_hero">
                          <option value="0">0</option>
                          <option value="5">1</option>
                          <option value="10">2</option>
                          <option value="15">3</option>
                        </select>
                      </div>
                    </div>
                    <div class="form-group row">
                      <div class="col-12 col-md-4">
                        <label class="col-form-label" data-i18n-key="defense_value_heroes">Valeur de défense Héros +5</label>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="def_team_hero">
                          <option value="0">0</option>
                          <option value="5">1</option>
                          <option value="10">2</option>
                          <option value="15">3</option>
                        </select>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="def_opponent_hero">
                          <option value="0">0</option>
                          <option value="5">1</option>
                          <option value="10">2</option>
                          <option value="15">3</option>
                        </select>
                      </div>
                    </div>

                    <div class="form-group row">
                      <div class="col-12 col-md-4">
                        <label class="col-form-label" data-i18n-key="defense_modifier_watchtower">Modificateur de défense de Tour +%</label>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="team_tower">
                          <option value="0">0</option>
                          <option value="0.1">10</option>
                          <option value="0.2">20</option>
                          <option value="0.3">30</option>
                          <option value="0.4">40</option>
                          <option value="0.5">50</option>
                          <option value="0.6">60</option>
                        </select>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="opponent_tower">
                          <option value="0">0</option>
                          <option value="0.1">10</option>
                          <option value="0.2">20</option>
                          <option value="0.3">30</option>
                          <option value="0.4">40</option>
                          <option value="0.5">50</option>
                          <option value="0.6">60</option>
                        </select>
                      </div>
                    </div>
                    <div class="form-group row">
                      <div class="col-12 col-md-4">
                        <label class="col-form-label" data-i18n-key="energy_cost_war">Coût en énergie Guerre -%</label>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="team_power">
                          <option value="1">0</option>
                          <option value="0.9">10</option>
                          <option value="0.8">20</option>
                          <option value="0.7">30</option>
                          <option value="0.6">40</option>
                          <option value="0.5">50</option>
                          <option value="0.4">60</option>
                        </select>
                      </div>
                      <div class="col-6 col-md-4">
                        <select class="form-select form-select-sm" id="opponent_power">
                          <option value="1">0</option>
                          <option value="0.9">10</option>
                          <option value="0.8">20</option>
                          <option value="0.7">30</option>
                          <option value="0.6">40</option>
                          <option value="0.5">50</option>
                          <option value="0.4">60</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
      </form>

    </div>
    <footer>
        <a href="https://discord.gg/szaPd6S" target="_blank" data-i18n-key="discord">Rejoignez-nous sur Discord</a> - <a href="https://github.com/rr2-france98/rr2-france98.github.io" target="_blank" data-i18n-key="sourcecode">Voir le code source</a>
        <br />
        <a href="https://royal-revolt-2.fandom.com/wiki/Conquest_Event" target="_blank">Wikia Conquest Event</a>
    </footer>

    <script>var i18n_file = "conquest";</script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
    <script type="text/javascript" src="js/regression.js?v1"></script>
    <script type="text/javascript" src="js/conquestCalculator.js?v3" defer></script>
    <script type="text/javascript" src="js/i18n.js?v1" defer></script>
    <script>
        const languageData = [{
          lang: 'fr',
          label: 'Français'
        }, {
          lang: 'en',
          label: 'English'
        }, {
          lang: 'es',
          label: 'Español'
        }];

        window.onload = () => {
          // populate language dropdown
          if (lang !== "fr") {
            loadLang(lang);
            // switch the data and icon to US English
            if (lang === 'us') {
              languageData[1].lang = lang;
              document.querySelector('#lang-flag').src = `./img/${lang}.png`
            }
          }

          // Create a map for the main label of the language dropdown
          const languageMap = languageData.map(item => { return {[item.lang]: item.label} }).reduce((acc, x) => Object.assign(acc, x), {});

          const languageDropdown = document.querySelector('#language-dropdown');
          const languageDropdownOptions = document.querySelector('#language-dropdown-options');

          languageDropdown.addEventListener('click', e => {
              e.preventDefault();

              if (e.target.classList.contains('dropdown-item')) {
                const lang = e.target.dataset.lang;

                languageDropdown.dataset.selectedLang = lang;
                languageDropdown.querySelector('a.dropdown-toggle').innerHTML = `<img src="./img/${lang}.png" alt="${lang}" width="32" height="21" /> ${languageMap[lang]}`;
                
                if (lang){
                  loadLang(lang);
                  if (window.localStorage) {
                    localStorage.setItem('wantLang', lang);
                  }
                }
              }

              return false;
          });
         

          const container = new DocumentFragment();
          
          languageData.forEach(option => {
            // Create DOM elements
            const item = document.createElement('li');
            const label = document.createElement('a');
            const flag = document.createElement('img');

            // Assign label properties
            label.id = `lang-option-${option.lang}`;
            label.classList.add('dropdown-item');
            label.dataset.lang = option.lang;
            label.href = '#';

            // Assign img properties
            flag.src = `./img/${option.lang}.png`;
            flag.alt = option.lang;
            flag.width = '32';
            flag.height = '21';

            label.appendChild(flag);
            label.appendChild(document.createTextNode(` ${option.label}`));

            item.appendChild(label);

            container.appendChild(item);
          });
          
          languageDropdownOptions.appendChild(container);

          // attacker / defender toggle
          const attackerToggle = document.querySelector('#attacker-toggle');
          const team = document.querySelector('#team');
          const opponent = document.querySelector('#opponent');
          
          attackerToggle.addEventListener('click', e => {
            const attacker = document.querySelector('#attacker');
            const isTeam = attacker.value === 'team';

            attacker.value = isTeam ? 'opponent' : 'team';

            // Switch the text 
            const textTmp = team.textContent;
            team.textContent = opponent.textContent;
            opponent.textContent = textTmp;

            // Switch the i18n
            const i18nTmp = team.dataset.i18nKey;
            team.dataset.i18nKey = opponent.dataset.i18nKey;
            opponent.dataset.i18nKey = i18nTmp;

            if (calc) {
              calc[e.target.id] = (!isNaN(e.target.value)) ? parseFloat(e.target.value) : e.target.value;
              calc.render();
            }
          });

          // Reset buttons
        };
    </script>
</body>
</html>

